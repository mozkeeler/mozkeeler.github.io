
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Personal Debug #ifdefs - mozkeeler</title>
  <meta name="author" content="David Keeler">

  
  <meta name="description" content="In looking at PSM code, I&rsquo;ve come across a practice that struck me as
undesirable. In the middle of some code I was attempting to understand &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mozkeeler.github.io/blog/2014/05/28/personal-debug-number-ifdefs">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="mozkeeler" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">mozkeeler</a></h1>
  
    <h2>Adventures at Mozilla</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:mozkeeler.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Personal Debug #ifdefs</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-28T16:55:17-07:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>In looking at PSM code, I&rsquo;ve come across a practice that struck me as
undesirable. In the middle of some code I was attempting to understand stood
the line <code>#ifdef DEBUG_handle</code>, where <code>handle</code> was the IRC nickname of a
developer no longer involved with Mozilla. My inference is that this developer
essentially checked in to the tree a debug mode personally tailored to the work
they were doing. I think this is problematic for a few reasons.</p>

<p>First, using the pre-processor to optionally include extra code not normally
tested or even run means other changes can easily break it. This allows broken
(and even un-compilable) code to persist long after it should have been fixed
or removed.</p>

<p>Second, using a personalized debug flag increases the difficulty for others
involved with the affected code. At best, it requires others to know of this
undocumented extra functionality for it to be useful. At worst, it obfucates
the meaning of the code and confuses developers unfamiliar with it.
Furthermore, when the developer who added it ceases involvement with Mozilla,
this orphaned code will be left to rot forever, without anyone knowing that it
exists. This isn&rsquo;t a sentimental issue - the more cruft the tree collects, the
harder it becomes to maintain.</p>

<p>Development does often require conditionally enabling additional debugging
output. Luckily for Gecko hackers, we already have a logging infrastructure
where different modules can be told to spew varying levels of debugging
information via environment variables.
This is <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSPR/Reference/Logging">NSPR logging</a>,
and it&rsquo;s enabled by default in debug builds. Compared to personal debug
#ifdefs (which are undocumented and require first determining the correct
build flags and then rebuilding the tree from scratch), NSPR logging is much
more versatile.</p>

<p>Finally, this practice is unprofessional. For similar reasons as to why we
don&rsquo;t check in debugging printfs left over from the development process and why
we adhere to a particular coding style, code specific to one developer should
never be added to a public project being worked on by many people.</p>

<p>When I started writing this post, I was worried this would be seen as a
personal issue since I only knew of one developer who engaged in this practice.
As it turns out, many Mozilla developers have checked in their own <code>#ifdef
DEBUG_handle</code>, including coders I know and respect. Perhaps they have some
counter-points to what I&rsquo;ve brought up here. However, while I won&rsquo;t be removing
all such cases across the tree, I do intend to stop this practice in PSM code.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">David Keeler</span></span>

      








  


<time datetime="2014-05-28T16:55:17-07:00" pubdate data-updated="true"></time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://mozkeeler.github.io/blog/2014/05/28/personal-debug-number-ifdefs/" data-via="" data-counturl="http://mozkeeler.github.io/blog/2014/05/28/personal-debug-number-ifdefs/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/04/18/nsconverttoactualkeygenparams-2-electric-boogaloo/" title="Previous Post: nsConvertToActualKeyGenParams 2: Electric Boogaloo">&laquo; nsConvertToActualKeyGenParams 2: Electric Boogaloo</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/06/03/history-lessons/" title="Next Post: History Lessons">History Lessons &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/02/02/my-weekend-with-pam/">My Weekend With PAM</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/06/03/history-lessons/">History Lessons</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/28/personal-debug-number-ifdefs/">Personal Debug #ifdefs</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/18/nsconverttoactualkeygenparams-2-electric-boogaloo/">nsConvertToActualKeyGenParams 2: Electric Boogaloo</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/16/leaky-input-parsing-in-nsconverttoactualkeygenparams/">Leaky Input Parsing in nsConvertToActualKeyGenParams</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - David Keeler -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
